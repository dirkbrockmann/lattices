!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.lattices=n():t.lattices=n()}(this,(()=>(()=>{"use strict";var t={d:(n,r)=>{for(var e in r)t.o(r,e)&&!t.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:r[e]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{void 0!==u&&u.toStringTag&&Object.defineProperty(t,u.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{hex:()=>hr,square:()=>ir,square_simple:()=>vr});const r=function(t){return t},e=function(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)};var o=Math.max;const a="object"==typeof global&&global&&global.Object===Object&&global;var i="object"==typeof self&&self&&self.Object===Object&&self;const c=a||i||Function("return this")();var u=c.Symbol;const l=u;var s=Object.prototype,f=s.hasOwnProperty,h=s.toString,p=l?l.toStringTag:void 0;var y=Object.prototype.toString;var v=l?l.toStringTag:void 0;const b=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":v&&v in Object(t)?function(t){var n=f.call(t,p),r=t[p];try{t[p]=void 0;var e=!0}catch(t){}var o=h.call(t);return e&&(n?t[p]=r:delete t[p]),o}(t):function(t){return y.call(t)}(t)},d=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)},m=function(t){if(!d(t))return!1;var n=b(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n},_=c["__core-js_shared__"];var g,j=(g=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"";var x=Function.prototype.toString;const O=function(t){if(null!=t){try{return x.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var M=/^\[object .+?Constructor\]$/,w=Function.prototype,E=Object.prototype,S=w.toString,A=E.hasOwnProperty,z=RegExp("^"+S.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const P=function(t){return!(!d(t)||(n=t,j&&j in n))&&(m(t)?z:M).test(O(t));var n},$=function(t,n){var r=function(t,n){return null==t?void 0:t[n]}(t,n);return P(r)?r:void 0},k=function(){try{var t=$(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),q=k?function(t,n){return k(t,"toString",{configurable:!0,enumerable:!1,value:(r=n,function(){return r}),writable:!0});var r}:r;var T=Date.now;const L=(N=q,F=0,I=0,function(){var t=T(),n=16-(t-I);if(I=t,n>0){if(++F>=800)return arguments[0]}else F=0;return N.apply(void 0,arguments)});var N,F,I;const B=function(t,n){for(var r=-1,e=null==t?0:t.length,o=0,a=[];++r<e;){var i=t[r];n(i,r,t)&&(a[o++]=i)}return a},D=function(t,n){for(var r=-1,e=null==t?0:t.length,o=Array(e);++r<e;)o[r]=n(t[r],r,t);return o},U=function(t){return function(n){return null==n?void 0:n[t]}},C=function(t,n){for(var r=-1,e=Array(t);++r<t;)e[r]=n(r);return e},R=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},V=function(t){return null!=t&&R(t.length)&&!m(t)},W=function(t){return null!=t&&"object"==typeof t};var G=Math.max;const H=function(t,n){return L(function(t,n,r){return n=o(void 0===n?t.length-1:n,0),function(){for(var a=arguments,i=-1,c=o(a.length-n,0),u=Array(c);++i<c;)u[i]=a[n+i];i=-1;for(var l=Array(n+1);++i<n;)l[i]=a[i];return l[n]=r(u),e(t,this,l)}}(t,n,r),t+"")}((function(t){if(!t||!t.length)return[];var n=0;return t=B(t,(function(t){if(W(r=t)&&V(r))return n=G(t.length,n),!0;var r})),C(n,(function(n){return D(t,U(n))}))}));var J=Math.ceil,K=Math.max;const Q=function(t,n){return t===n||t!=t&&n!=n};var X=/^(?:0|[1-9]\d*)$/;const Y=function(t,n){var r=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&X.test(t))&&t>-1&&t%1==0&&t<n};var Z=/\s/;var tt=/^\s+/;const nt=function(t){return t?t.slice(0,function(t){for(var n=t.length;n--&&Z.test(t.charAt(n)););return n}(t)+1).replace(tt,""):t},rt=function(t){return"symbol"==typeof t||W(t)&&"[object Symbol]"==b(t)};var et=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,at=/^0o[0-7]+$/i,it=parseInt;const ct=function(t){return t?Infinity===(t=function(t){if("number"==typeof t)return t;if(rt(t))return NaN;if(d(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=d(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=nt(t);var r=ot.test(t);return r||at.test(t)?it(t.slice(2),r?2:8):et.test(t)?NaN:+t}(t))||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},ut=function(t,n,r){return r&&"number"!=typeof r&&function(t,n,r){if(!d(r))return!1;var e=typeof n;return!!("number"==e?V(r)&&Y(n,r.length):"string"==e&&n in r)&&Q(r[n],t)}(t,n,r)&&(n=r=void 0),t=ct(t),void 0===n?(n=t,t=0):n=ct(n),function(t,n,r,e){for(var o=-1,a=K(J((n-t)/(r||1)),0),i=Array(a);a--;)i[e?a:++o]=t,t+=r;return i}(t,n,r=void 0===r?t<n?1:-1:ct(r),void 0)},lt=function(t,n,r){for(var e=-1,o=Object(t),a=r(t),i=a.length;i--;){var c=a[++e];if(!1===n(o[c],c,o))break}return t},st=function(t){return W(t)&&"[object Arguments]"==b(t)};var ft=Object.prototype,ht=ft.hasOwnProperty,pt=ft.propertyIsEnumerable;const yt=st(function(){return arguments}())?st:function(t){return W(t)&&ht.call(t,"callee")&&!pt.call(t,"callee")},vt=Array.isArray;var bt="object"==typeof exports&&exports&&!exports.nodeType&&exports,dt=bt&&"object"==typeof module&&module&&!module.nodeType&&module,mt=dt&&dt.exports===bt?c.Buffer:void 0;const _t=(mt?mt.isBuffer:void 0)||function(){return!1};var gt={};gt["[object Float32Array]"]=gt["[object Float64Array]"]=gt["[object Int8Array]"]=gt["[object Int16Array]"]=gt["[object Int32Array]"]=gt["[object Uint8Array]"]=gt["[object Uint8ClampedArray]"]=gt["[object Uint16Array]"]=gt["[object Uint32Array]"]=!0,gt["[object Arguments]"]=gt["[object Array]"]=gt["[object ArrayBuffer]"]=gt["[object Boolean]"]=gt["[object DataView]"]=gt["[object Date]"]=gt["[object Error]"]=gt["[object Function]"]=gt["[object Map]"]=gt["[object Number]"]=gt["[object Object]"]=gt["[object RegExp]"]=gt["[object Set]"]=gt["[object String]"]=gt["[object WeakMap]"]=!1;var jt="object"==typeof exports&&exports&&!exports.nodeType&&exports,xt=jt&&"object"==typeof module&&module&&!module.nodeType&&module,Ot=xt&&xt.exports===jt&&a.process,Mt=function(){try{return xt&&xt.require&&xt.require("util").types||Ot&&Ot.binding&&Ot.binding("util")}catch(t){}}(),wt=Mt&&Mt.isTypedArray;const Et=wt?function(t){return function(n){return t(n)}}(wt):function(t){return W(t)&&R(t.length)&&!!gt[b(t)]};var St=Object.prototype.hasOwnProperty;var At=Object.prototype;const zt=function(t,n){return function(r){return t(n(r))}}(Object.keys,Object);var Pt=Object.prototype.hasOwnProperty;const $t=function(t){if(r=(n=t)&&n.constructor,n!==("function"==typeof r&&r.prototype||At))return zt(t);var n,r,e=[];for(var o in Object(t))Pt.call(t,o)&&"constructor"!=o&&e.push(o);return e},kt=function(t){return V(t)?function(t,n){var r=vt(t),e=!r&&yt(t),o=!r&&!e&&_t(t),a=!r&&!e&&!o&&Et(t),i=r||e||o||a,c=i?C(t.length,String):[],u=c.length;for(var l in t)!n&&!St.call(t,l)||i&&("length"==l||o&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Y(l,u))||c.push(l);return c}(t):$t(t)},qt=function(t,n){if(null==t)return t;if(!V(t))return function(t,n){return t&&lt(t,n,kt)}(t,n);for(var r=t.length,e=-1,o=Object(t);++e<r&&!1!==n(o[e],e,o););return t},Tt=function(t,n){var r=[];return qt(t,(function(t,e,o){n(t,e,o)&&r.push(t)})),r},Lt=function(t,n){for(var r=t.length;r--;)if(Q(t[r][0],n))return r;return-1};var Nt=Array.prototype.splice;function Ft(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}Ft.prototype.clear=function(){this.__data__=[],this.size=0},Ft.prototype.delete=function(t){var n=this.__data__,r=Lt(n,t);return!(r<0||(r==n.length-1?n.pop():Nt.call(n,r,1),--this.size,0))},Ft.prototype.get=function(t){var n=this.__data__,r=Lt(n,t);return r<0?void 0:n[r][1]},Ft.prototype.has=function(t){return Lt(this.__data__,t)>-1},Ft.prototype.set=function(t,n){var r=this.__data__,e=Lt(r,t);return e<0?(++this.size,r.push([t,n])):r[e][1]=n,this};const It=Ft,Bt=$(c,"Map"),Dt=$(Object,"create");var Ut=Object.prototype.hasOwnProperty;var Ct=Object.prototype.hasOwnProperty;function Rt(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}Rt.prototype.clear=function(){this.__data__=Dt?Dt(null):{},this.size=0},Rt.prototype.delete=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n},Rt.prototype.get=function(t){var n=this.__data__;if(Dt){var r=n[t];return"__lodash_hash_undefined__"===r?void 0:r}return Ut.call(n,t)?n[t]:void 0},Rt.prototype.has=function(t){var n=this.__data__;return Dt?void 0!==n[t]:Ct.call(n,t)},Rt.prototype.set=function(t,n){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Dt&&void 0===n?"__lodash_hash_undefined__":n,this};const Vt=Rt,Wt=function(t,n){var r,e,o=t.__data__;return("string"==(e=typeof(r=n))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==r:null===r)?o["string"==typeof n?"string":"hash"]:o.map};function Gt(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}Gt.prototype.clear=function(){this.size=0,this.__data__={hash:new Vt,map:new(Bt||It),string:new Vt}},Gt.prototype.delete=function(t){var n=Wt(this,t).delete(t);return this.size-=n?1:0,n},Gt.prototype.get=function(t){return Wt(this,t).get(t)},Gt.prototype.has=function(t){return Wt(this,t).has(t)},Gt.prototype.set=function(t,n){var r=Wt(this,t),e=r.size;return r.set(t,n),this.size+=r.size==e?0:1,this};const Ht=Gt;function Jt(t){var n=this.__data__=new It(t);this.size=n.size}Jt.prototype.clear=function(){this.__data__=new It,this.size=0},Jt.prototype.delete=function(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r},Jt.prototype.get=function(t){return this.__data__.get(t)},Jt.prototype.has=function(t){return this.__data__.has(t)},Jt.prototype.set=function(t,n){var r=this.__data__;if(r instanceof It){var e=r.__data__;if(!Bt||e.length<199)return e.push([t,n]),this.size=++r.size,this;r=this.__data__=new Ht(e)}return r.set(t,n),this.size=r.size,this};const Kt=Jt;function Qt(t){var n=-1,r=null==t?0:t.length;for(this.__data__=new Ht;++n<r;)this.add(t[n])}Qt.prototype.add=Qt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Qt.prototype.has=function(t){return this.__data__.has(t)};const Xt=Qt,Yt=function(t,n){for(var r=-1,e=null==t?0:t.length;++r<e;)if(n(t[r],r,t))return!0;return!1},Zt=function(t,n,r,e,o,a){var i=1&r,c=t.length,u=n.length;if(c!=u&&!(i&&u>c))return!1;var l=a.get(t),s=a.get(n);if(l&&s)return l==n&&s==t;var f=-1,h=!0,p=2&r?new Xt:void 0;for(a.set(t,n),a.set(n,t);++f<c;){var y=t[f],v=n[f];if(e)var b=i?e(v,y,f,n,t,a):e(y,v,f,t,n,a);if(void 0!==b){if(b)continue;h=!1;break}if(p){if(!Yt(n,(function(t,n){if(i=n,!p.has(i)&&(y===t||o(y,t,r,e,a)))return p.push(n);var i}))){h=!1;break}}else if(y!==v&&!o(y,v,r,e,a)){h=!1;break}}return a.delete(t),a.delete(n),h},tn=c.Uint8Array,nn=function(t){var n=-1,r=Array(t.size);return t.forEach((function(t,e){r[++n]=[e,t]})),r},rn=function(t){var n=-1,r=Array(t.size);return t.forEach((function(t){r[++n]=t})),r};var en=l?l.prototype:void 0,on=en?en.valueOf:void 0;var an=Object.prototype.propertyIsEnumerable,cn=Object.getOwnPropertySymbols;const un=cn?function(t){return null==t?[]:(t=Object(t),B(cn(t),(function(n){return an.call(t,n)})))}:function(){return[]},ln=function(t){return function(t,n,r){var e=n(t);return vt(t)?e:function(t,n){for(var r=-1,e=n.length,o=t.length;++r<e;)t[o+r]=n[r];return t}(e,r(t))}(t,kt,un)};var sn=Object.prototype.hasOwnProperty;const fn=$(c,"DataView"),hn=$(c,"Promise"),pn=$(c,"Set"),yn=$(c,"WeakMap");var vn="[object Map]",bn="[object Promise]",dn="[object Set]",mn="[object WeakMap]",_n="[object DataView]",gn=O(fn),jn=O(Bt),xn=O(hn),On=O(pn),Mn=O(yn),wn=b;(fn&&wn(new fn(new ArrayBuffer(1)))!=_n||Bt&&wn(new Bt)!=vn||hn&&wn(hn.resolve())!=bn||pn&&wn(new pn)!=dn||yn&&wn(new yn)!=mn)&&(wn=function(t){var n=b(t),r="[object Object]"==n?t.constructor:void 0,e=r?O(r):"";if(e)switch(e){case gn:return _n;case jn:return vn;case xn:return bn;case On:return dn;case Mn:return mn}return n});const En=wn;var Sn="[object Arguments]",An="[object Array]",zn="[object Object]",Pn=Object.prototype.hasOwnProperty;const $n=function(t,n,r,e,o,a){var i=vt(t),c=vt(n),u=i?An:En(t),l=c?An:En(n),s=(u=u==Sn?zn:u)==zn,f=(l=l==Sn?zn:l)==zn,h=u==l;if(h&&_t(t)){if(!_t(n))return!1;i=!0,s=!1}if(h&&!s)return a||(a=new Kt),i||Et(t)?Zt(t,n,r,e,o,a):function(t,n,r,e,o,a,i){switch(r){case"[object DataView]":if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=n.byteLength||!a(new tn(t),new tn(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Q(+t,+n);case"[object Error]":return t.name==n.name&&t.message==n.message;case"[object RegExp]":case"[object String]":return t==n+"";case"[object Map]":var c=nn;case"[object Set]":var u=1&e;if(c||(c=rn),t.size!=n.size&&!u)return!1;var l=i.get(t);if(l)return l==n;e|=2,i.set(t,n);var s=Zt(c(t),c(n),e,o,a,i);return i.delete(t),s;case"[object Symbol]":if(on)return on.call(t)==on.call(n)}return!1}(t,n,u,r,e,o,a);if(!(1&r)){var p=s&&Pn.call(t,"__wrapped__"),y=f&&Pn.call(n,"__wrapped__");if(p||y){var v=p?t.value():t,b=y?n.value():n;return a||(a=new Kt),o(v,b,r,e,a)}}return!!h&&(a||(a=new Kt),function(t,n,r,e,o,a){var i=1&r,c=ln(t),u=c.length;if(u!=ln(n).length&&!i)return!1;for(var l=u;l--;){var s=c[l];if(!(i?s in n:sn.call(n,s)))return!1}var f=a.get(t),h=a.get(n);if(f&&h)return f==n&&h==t;var p=!0;a.set(t,n),a.set(n,t);for(var y=i;++l<u;){var v=t[s=c[l]],b=n[s];if(e)var d=i?e(b,v,s,n,t,a):e(v,b,s,t,n,a);if(!(void 0===d?v===b||o(v,b,r,e,a):d)){p=!1;break}y||(y="constructor"==s)}if(p&&!y){var m=t.constructor,_=n.constructor;m==_||!("constructor"in t)||!("constructor"in n)||"function"==typeof m&&m instanceof m&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(t),a.delete(n),p}(t,n,r,e,o,a))},kn=function t(n,r,e,o,a){return n===r||(null==n||null==r||!W(n)&&!W(r)?n!=n&&r!=r:$n(n,r,e,o,t,a))},qn=function(t){return t==t&&!d(t)},Tn=function(t,n){return function(r){return null!=r&&r[t]===n&&(void 0!==n||t in Object(r))}},Ln=function(t){var n=function(t){for(var n=kt(t),r=n.length;r--;){var e=n[r],o=t[e];n[r]=[e,o,qn(o)]}return n}(t);return 1==n.length&&n[0][2]?Tn(n[0][0],n[0][1]):function(r){return r===t||function(t,n,r,e){var o=r.length,a=o,i=!e;if(null==t)return!a;for(t=Object(t);o--;){var c=r[o];if(i&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<a;){var u=(c=r[o])[0],l=t[u],s=c[1];if(i&&c[2]){if(void 0===l&&!(u in t))return!1}else{var f=new Kt;if(e)var h=e(l,s,u,t,n,f);if(!(void 0===h?kn(s,l,3,e,f):h))return!1}}return!0}(r,t,n)}};var Nn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fn=/^\w*$/;const In=function(t,n){if(vt(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!rt(t))||Fn.test(t)||!Nn.test(t)||null!=n&&t in Object(n)};function Bn(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var r=function(){var e=arguments,o=n?n.apply(this,e):e[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,e);return r.cache=a.set(o,i)||a,i};return r.cache=new(Bn.Cache||Ht),r}Bn.Cache=Ht;var Dn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Un=/\\(\\)?/g;const Cn=(Rn=Bn((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Dn,(function(t,r,e,o){n.push(e?o.replace(Un,"$1"):r||t)})),n}),(function(t){return 500===Vn.size&&Vn.clear(),t})),Vn=Rn.cache,Rn);var Rn,Vn,Wn=l?l.prototype:void 0,Gn=Wn?Wn.toString:void 0;const Hn=function t(n){if("string"==typeof n)return n;if(vt(n))return D(n,t)+"";if(rt(n))return Gn?Gn.call(n):"";var r=n+"";return"0"==r&&1/n==-1/0?"-0":r},Jn=function(t){return null==t?"":Hn(t)},Kn=function(t,n){return vt(t)?t:In(t,n)?[t]:Cn(Jn(t))},Qn=function(t){if("string"==typeof t||rt(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},Xn=function(t,n){for(var r=0,e=(n=Kn(n,t)).length;null!=t&&r<e;)t=t[Qn(n[r++])];return r&&r==e?t:void 0},Yn=function(t,n){return null!=t&&n in Object(t)},Zn=function(t,n){return null!=t&&function(t,n,r){for(var e=-1,o=(n=Kn(n,t)).length,a=!1;++e<o;){var i=Qn(n[e]);if(!(a=null!=t&&r(t,i)))break;t=t[i]}return a||++e!=o?a:!!(o=null==t?0:t.length)&&R(o)&&Y(i,o)&&(vt(t)||yt(t))}(t,n,Yn)},tr=function(t,n){return In(t)&&qn(n)?Tn(Qn(t),n):function(r){var e=function(t,n,r){var e=null==t?void 0:Xn(t,n);return void 0===e?r:e}(r,t);return void 0===e&&e===n?Zn(r,t):kn(n,e,3)}},nr=function(t){return In(t)?U(Qn(t)):function(t){return function(n){return Xn(n,t)}}(t)},rr=function(t,n){return(vt(t)?B:Tt)(t,"function"==typeof(e=n)?e:null==e?r:"object"==typeof e?vt(e)?tr(e[0],e[1]):Ln(e):nr(e));var e};function er(t,n){return[t%n,Math.floor(t/n)]}const or={n4:H([-1,1,0,0],[0,0,-1,1]),n8:H([-1,0,1,1,1,0,-1,-1],[-1,-1,-1,0,1,1,1,0])};function ar(t,n,r="periodic",e="n8"){const o=[];return or[e].forEach((e=>{var a=e[1],i=e[0];const c=er(t,n),u=c[0]+i,l=c[1]+a;("dirichlet"==r?(0!=a||0!=i)&&u<n&&l<n&&u>=0&&l>=0:0!=a||0!=i)&&o.push(n*((l+n)%n)+(u+n)%n)})),o}const ir=function(t){var n="periodic",r=1,e="n8";const o=2*t+1;var a=r/o,i=a;const c=ut(o*o).map((function(t){const n=er(t,o);return{m:n[0],n:n[1],x:a*(n[0]+.5)-r/2,y:i*(n[1]+.5)-r/2}}));return c.forEach((function(t,r){t.neighbors=ar(r,o,n,e).map((t=>c[t])),t.cell=()=>[{x:t.x+a/2,y:t.y+i/2},{x:t.x-a/2,y:t.y+i/2},{x:t.x-a/2,y:t.y-i/2},{x:t.x+a/2,y:t.y-i/2},{x:t.x+a/2,y:t.y+i/2}],t.random_interior_point=()=>({x:t.x+a*(Math.random()-.5),y:t.y+i*(Math.random()-.5)})})),{type:"square",L:r,N:t,size:o*o,hood:function(t){return void 0!==t?(c.forEach((function(r,e){r.neighbors=ar(e,o,n,t).map((t=>c[t]))})),e=t,this):e},nodes:c,scale:function(t){return void 0!==t?(c.forEach((function(n){n.x=(n.m+.5)*t/o-t/2,n.y=(n.n+.5)*t/o-t/2})),a=(r=t)/o,i=r/o,this.L=r,this):r},boundary:function(r){return void 0!==r?(c.forEach((function(t,n){t.neighbors=ar(n,o,r,e).map((t=>c[t]))})),n=r,c.forEach((r=>{r.is_boundary="dirichlet"==n&&(0==r.n||r.n==2*t||0==r.m||r.m==2*t)})),this):n},boundary_cells:function(){return"periodic"===n?null:rr(c,(n=>0==n.n||n.n==2*t||0==n.m||n.m==2*t))}}},cr=[1,0],ur=[.5,Math.sqrt(3)/2],lr=[{l:1,m:0,n:-1},{l:1,m:-1,n:0},{l:0,m:-1,n:1},{l:0,m:1,n:-1},{l:-1,m:0,n:1},{l:-1,m:1,n:0}],sr=[[lr[0],lr[1]],[lr[1],lr[2]],[lr[2],lr[4]],[lr[4],lr[5]],[lr[5],lr[3]],[lr[3],lr[0]]];function fr(t){return"id_l"+t.l+"m"+t.m+"n"+t.n}const hr=function(t){var n="periodic",r=1,e=r/(2*t+1);const o=[],a={};return ut(-t,t+1).forEach((function(n){ut(-t,t+1).forEach((function(r){ut(-t,t+1).forEach((function(t){n+r+t==0&&o.push({l:n,m:r,n:t,x:e*n*cr[0]+e*r*ur[0],y:e*n*cr[1]+e*r*ur[1]})}))}))})),o.forEach((function(t){a[fr(t)]=t,t.cell=()=>{const n=1/Math.sqrt(3);return[{x:t.x+e/2,y:t.y+n*e/2},{x:t.x,y:t.y+n*e},{x:t.x-e/2,y:t.y+n*e/2},{x:t.x-e/2,y:t.y-n*e/2},{x:t.x,y:t.y-n*e},{x:t.x+e/2,y:t.y-n*e/2},{x:t.x+e/2,y:t.y+n*e/2}]},t.random_interior_point=()=>{const n=1/Math.sqrt(3),r=Math.random(),o=Math.random(),a=2*Math.floor(6*Math.random())*Math.PI/6,i=e/2*Math.sqrt(r),c=e/2*Math.sqrt(r)*n*(1-2*o),u=Math.cos(a)*i-Math.sin(a)*c,l=Math.sin(a)*i+Math.cos(a)*c;return{x:t.x+u,y:t.y+l}}})),i(o),{type:"hexagonal",L:r,N:t,size:1+3*t*(t+1),nodes:o,scale:function(n){return void 0!==n?(e=(r=n)/(2*t+1),o.forEach((t=>{t.x=e*t.l*cr[0]+e*t.m*ur[0],t.y=e*t.l*cr[1]+e*t.m*ur[1]})),this.L=r,this):r},boundary:function(r){return void 0!==r?("dirichlet"==r?(n="dirichlet",(e=o).forEach((function(t){t.neighbors=[],lr.forEach((function(n){const r=fr({l:t.l+n.l,m:t.m+n.m,n:t.n+n.n}),e=a[r];void 0!==e&&t.neighbors.push(e)}))})),e.forEach((function(t){t.triangles=[],sr.forEach((function(n){const r=fr({l:t.l+n[0].l,m:t.m+n[0].m,n:t.n+n[0].n}),e=fr({l:t.l+n[1].l,m:t.m+n[1].m,n:t.n+n[1].n});void 0!==a[r]&&void 0!==a[e]&&t.triangles.push([a[r],a[e]])}))}))):(n="periodic",i(o)),o.forEach((r=>{r.is_boundary="dirichlet"==n&&(r.n==-t||r.n==t||r.l==-t||r.l==t||r.m==-t||r.m==t)})),this):n;var e},boundary_cells:function(){return"periodic"===n?null:rr(o,(n=>n.n==-t||n.n==t||n.l==-t||n.l==t||n.m==-t||n.m==t))},cell:function(n){var r=1/Math.sqrt(3);return[{x:n.x+Scale/t/2,y:n.y+r/2*Scale/t},{x:n.x,y:n.y+r*Scale/t},{x:n.x-Scale/t/2,y:n.y+r/2*Scale/t},{x:n.x-Scale/t/2,y:n.y-r/2*Scale/t},{x:n.x,y:n.y-r*Scale/t},{x:n.x+Scale/t/2,y:n.y-r/2*Scale/t},{x:n.x+Scale/t/2,y:n.y+r/2*Scale/t}]}};function i(n){n.forEach((function(n){n.neighbors=[],lr.forEach((function(r){var e=fr({l:n.l+r.l,m:n.m+r.m,n:n.n+r.n});void 0===a[e]&&(n.l+r.l==t+1&&Math.abs(n.m+r.m)<=t+1&&Math.abs(n.n+r.n)<=t&&(e=fr({l:n.l+r.l-(2*t+1),m:n.m+r.m+(t+1),n:n.n+r.n+t})),n.l+r.l==-(t+1)&&Math.abs(n.m+r.m)<=t+1&&Math.abs(n.n+r.n)<=t&&(e=fr({l:n.l+r.l+(2*t+1),m:n.m+r.m-(t+1),n:n.n+r.n-t})),n.m+r.m==t+1&&Math.abs(n.l+r.l)<=t&&Math.abs(n.n+r.n)<=t+1&&(e=fr({m:n.m+r.m-(2*t+1),n:n.n+r.n+(t+1),l:n.l+r.l+t})),n.m+r.m==-(t+1)&&Math.abs(n.l+r.l)<=t&&Math.abs(n.n+r.n)<=t+1&&(e=fr({m:n.m+r.m+(2*t+1),n:n.n+r.n-(t+1),l:n.l+r.l-t})),n.n+r.n==t+1&&Math.abs(n.l+r.l)<=t+1&&Math.abs(n.m+r.m)<=t&&(e=fr({n:n.n+r.n-(2*t+1),l:n.l+r.l+(t+1),m:n.m+r.m+t})),n.n+r.n==-(t+1)&&Math.abs(n.l+r.l)<=t+1&&Math.abs(n.m+r.m)<=t&&(e=fr({n:n.n+r.n+(2*t+1),l:n.l+r.l-(t+1),m:n.m+r.m-t}))),n.neighbors.push(a[e])}))})),n.forEach((function(n){n.triangles=[],sr.forEach((function(r){var e=[];r.forEach((function(r,o){var i=fr({l:n.l+r.l,m:n.m+r.m,n:n.n+r.n});void 0===a[i]&&(n.l+r.l==t+1&&Math.abs(n.m+r.m)<=t+1&&Math.abs(n.n+r.n)<=t&&fr({l:n.l+r.l-(2*t+1),m:n.m+r.m+(t+1),n:n.n+r.n+t}),n.l+r.l==-(t+1)&&Math.abs(n.m+r.m)<=t+1&&Math.abs(n.n+r.n)<=t&&fr({l:n.l+r.l+(2*t+1),m:n.m+r.m-(t+1),n:n.n+r.n-t}),n.m+r.m==t+1&&Math.abs(n.l+r.l)<=t&&Math.abs(n.n+r.n)<=t+1&&fr({m:n.m+r.m-(2*t+1),n:n.n+r.n+(t+1),l:n.l+r.l+t}),n.m+r.m==-(t+1)&&Math.abs(n.l+r.l)<=t&&Math.abs(n.n+r.n)<=t+1&&fr({m:n.m+r.m+(2*t+1),n:n.n+r.n-(t+1),l:n.l+r.l-t}),n.n+r.n==t+1&&Math.abs(n.l+r.l)<=t+1&&Math.abs(n.m+r.m)<=t&&fr({n:n.n+r.n-(2*t+1),l:n.l+r.l+(t+1),m:n.m+r.m+t}),n.n+r.n==-(t+1)&&Math.abs(n.l+r.l)<=t+1&&Math.abs(n.m+r.m)<=t&&fr({n:n.n+r.n+(2*t+1),l:n.l+r.l-(t+1),m:n.m+r.m-t})),e[o]=i})),n.triangles.push([a[e[0]],a[e[1]]])}))}))}},pr={n4:H([-1,1,0,0],[0,0,-1,1]),n8:H([-1,0,1,1,1,0,-1,-1],[-1,-1,-1,0,1,1,1,0])};function yr(t,n,r="periodic",e="n8"){const o=[];return pr[e].forEach((e=>{var a=e[1],i=e[0];const c=er(t,n),u=c[0]+i,l=c[1]+a;("dirichlet"==r?(0!=a||0!=i)&&u<n&&l<n&&u>=0&&l>=0:0!=a||0!=i)&&o.push(n*((l+n)%n)+(u+n)%n)})),o}const vr=function(t){var n="periodic",r=t,e="n8";const o=ut(t*t).map((function(n){const r=er(n,t);return{x:r[0],y:r[1]}}));return o.forEach((function(r,a){r.neighbors=yr(a,t,n,e).map((t=>o[t])),r.cell=()=>[{x:r.x,y:r.y},{x:r.x+1,y:r.y},{x:r.x+1,y:r.y+1},{x:r.x,y:r.y+1},{x:r.x,y:r.y}]})),{type:"square",L:r,N:t,size:t,hood:function(r){return void 0!==r?(o.forEach((function(e,a){e.neighbors=yr(a,t,n,r).map((t=>o[t]))})),e=r,this):e},nodes:o,scale:function(n){return t},boundary:function(r){return void 0!==r?(o.forEach((function(n,a){n.neighbors=yr(a,t,r,e).map((t=>o[t]))})),n=r,this):n}}};return n})()));